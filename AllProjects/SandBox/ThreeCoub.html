<!DOCTYPE HTML>
<html>
<head>
	<title>Three.js coub</title>
	<meta charset="utf-8">
	<script src="three.js"></script>
</head>
<body>
	 <style>
  * {
      margin: 0;
      padding: 0;
  }
</style>
      <script>
      	var scene, camera, renderer;
      
      		container = document.createElement('div');
      		document.body.appendChild(container);
            
            camera = new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,0.1,1000);
            camera.position.y = 0;
            camera.position.z = 1000;

            scene = new THREE.Scene();
             
             var cube_geometry= new THREE.CubeGeometry(100,100,100);
             var cube_texture = new THREE.MeshNormalMaterial({color: 0x7fffb7});
             var cube = new THREE.Mesh(cube_geometry,cube_texture);
             var mas = [];
             for(var i = 0;i<4;i++)
             {
             	mas[i] = new THREE.Mesh(cube_geometry,cube_texture);
             	mas[i].position.y = i*100;
             	
             	scene.add(mas[i]);
             }
               var chislo = 4;





            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth,window.innerHeight);
            renderer.setClearColor (0xffffff, 1);
            container.appendChild(renderer.domElement);

            cube.position.y = 0;
            var angle = 0;
              var speedx = [];
             var speedy = [];
             var speedz = [];
             for(var i = 0;i<4;i++)
             {
             	speedx[i] = Rand(-10,10);
             	while(speedx[i]==0)
             	{
             	speedx[i] = Rand(-10,10);
                 }
             }
                for(var i = 0;i<4;i++)
             {
             	speedy[i] = Rand(-10,10);
             	while(speedy[i]==0)
             	{
             	speedy[i] = Rand(-10,10);
                }
             } for(var i = 0;i<4;i++)
             {
             	speedz[i] = Rand(5,8);
             	while(speedy[i]==0)
             	{
             	speedz[i] = Rand(5,8);
                }
             }
          
            
   var n2 = [];
   var n3 = [];
   var n1 = [];
   for(var i = 0;i<chislo;i++)
             {
             	n1[i] = 1;

             	n2[i] = 1;
             	n3[i] = 1;
             }

            animation();


            function animation(){
            requestAnimationFrame(animation);
            for(var i = 0;i < chislo;i++)
            {


                 
                var x = speedx[i];
                var y = speedy[i];
                var z = speedz[i];
              mas[i].position.y += n1[i]*y;
               mas[i].rotation.y += n1[i]*y/100;
               if( (Math.abs(mas[i].position.y) - Math.abs(y))>window.innerHeight)
               {
                  n1[i]=-n1[i];
               }

              mas[i].position.x += n2[i]*x;
              mas[i].rotation.x += n2[i]*x/100;


              if( (Math.abs(mas[i].position.x) - Math.abs(x))>window.innerWidth)
               {
               	 n2[i]=-n2[i];
               }
               mas[i].position.z += n3[i]*z;
               if(( mas[i].position.z>800)||(mas[i].position.z<0))
               {
             
             	n3[i]=-n3[i];
               }
             }
             // for (var a = 0 ; a<3;a++)
             // {
             //      if((mas[a].position.x=mas[a+1].position.x)||(mas[a].position.y=mas[a+1].position.y))	
             //      {
             //      	speedx[a] = -speedx[a];
             //      	speedy[a] = - speedy[a];
             //      	 mas[a].position.x += n*10;
             //      	 mas[a].position.y += n*10;
             //      }
             // }
             // angle += Math.PI/180*2;
             // mas[i].rotation.z += 180/Math.PI*0.0001;
              renderer.render(scene,camera);
      			

                }

                function Rand(min, max) {
           return Math.floor(Math.random() * (max - min + 1)) + min;
            }

            document.addEventListener('keydown', function () {
         
                 chislo+=1;
             	mas[chislo-1] = new THREE.Mesh(cube_geometry,cube_texture);
             	
             	
             	scene.add(mas[chislo-1]);

                            	speedx[chislo-1] = Rand(-10,10);
             	while(speedx[chislo-1]==0)
             	{
             	speedx[chislo-1] = Rand(-10,10);
                 }
             
             	speedy[chislo-1] = Rand(-10,10);
             	while(speedy[chislo-1]==0)
             	{
             	speedy[chislo-1] = Rand(-10,10);
                }
             	speedz[chislo-1] = Rand(5,8);
                n1[chislo-1]=1;
                n3[chislo-1]=1;
                n2[chislo-1]=1;
             

             }
                );
            document.addEventListener('touchstart', function () {
            chislo+=1;
             	mas[chislo-1] = new THREE.Mesh(cube_geometry,cube_texture);
             	
             	
             	scene.add(mas[chislo-1]);

                            	speedx[chislo-1] = Rand(-10,10);
             	while(speedx[chislo-1]==0)
             	{
             	speedx[chislo-1] = Rand(-10,10);
                 }
             
             	speedy[chislo-1] = Rand(-10,10);
             	while(speedy[chislo-1]==0)
             	{
             	speedy[chislo-1] = Rand(-10,10);
                }
             	speedz[chislo-1] = Rand(5,8);
                n1[chislo-1]=1;
                n3[chislo-1]=1;
                n2[chislo-1]=1;
              });


      </script>
</body>
</html>
